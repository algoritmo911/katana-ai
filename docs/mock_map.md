# Mock Map

This document tracks all mocks and placeholders in the Katana-AI project.

| File | Function/Section | Mock Description | Planned Replacement |
|---|---|---|---|
| `bot/katana_bot.py` | `get_katana_response` | Returns a hardcoded string, simulating an NLP model response. Marked with `(это заглушка)`. | Replace with actual calls to an NLP client (e.g., OpenAI or Anthropic, using `bot/nlp_clients/`). |
| `bot/katana_bot.py` | `handle_log_event` | Logs to console, marked with `(заглушка)`. Does not perform real event logging or telemetry. | Integrate with `src/telemetry/command_telemetry.py` for structured event logging to `command_telemetry.log`. |
| `bot/katana_bot.py` | `handle_mind_clearing` | Logs to console, marked with `(заглушка)`. Uses `memory_manager.clear_history()`. | Review if current `MemoryManager` call is sufficient. The mock status suggests it might need more, e.g., specific telemetry logging via `command_telemetry.py`. |
| `bot/katana_bot.py` | JSON command saving (in `handle_message_impl`) | Saves received JSON commands directly to files in `commands/` directory. | This is a temporary mechanism. Plan to replace or supplement with task processing via `TaskOrchestrator` which will handle structured tasks, potentially originating from these commands or DAO. |
| `src/orchestrator/task_orchestrator.py` | `JuliusAgent.process_tasks` | Abstract method with `raise NotImplementedError`. The orchestrator requires a concrete agent. | Implement a concrete class `KatanaTaskProcessor(JuliusAgent)` that contains the actual task processing logic, including calling `core_connector.py` and logging telemetry. |
| `src/dao/dao_task_handler.py` | `fetch_tasks_from_colony` | Currently returns a predefined list of mock task dictionaries if no endpoint is provided. If an endpoint is provided, it prints "Not implemented yet". | Implement actual API call to a Colony public endpoint if available. If not, enhance mock generation or allow loading from a local test file. |
| `src/connectors/core_connector.py` | `call_sc_core` | Simulates a call to "SC Core" with hardcoded success/failure logic based on task type and `time.sleep(0.1)`. Returns mock responses. | Replace with actual calls to the target SC Core API/service. This might involve HTTP requests, library calls, etc., depending on the nature of SC Core. |
| `src/tools/rclone_sync.py` | `sync_data_with_rclone` (if `RCLONE_EXE` is None) | Returns `False` with an error message if `rclone` executable is not found. | This is expected behavior if `rclone` is not installed. For testing, ensure `rclone` is available in the environment or mock the `subprocess.run` call for unit tests. For integration, `rclone` must be installed. |
| `run_integration_test.py` | `MockKatanaTaskProcessor` | This is a mock agent created specifically for the integration test. | This is acceptable for testing, but the real `KatanaTaskProcessor` will need to be developed for production. The mock helps define the interface. |
| `run_integration_test.py` | `katana.history.json` handling | The test script initializes `test_run_katana.history.json` but doesn't actively populate it from bot/orchestrator logic yet. | Integrate actual history logging (chat or task events) from `MemoryManager` (Redis) or other sources into a mechanism that can be verified against this file or its test equivalent. |
